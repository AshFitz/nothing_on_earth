# Nothing On Earth

<p> Nothing on Earth offers trend-led dresses that are unique and fresh. We encourage you to have total freedom to experiment and express yourself through our collections. We aim to release a new collection every 8 weeks, with timeless pieces you will treasure forever. Each time we realse a new collection, we will offer a mystery sale item that will be half the original price.
</p>

<img src="https://github.com/AshFitz/nothing_on_earth/blob/main/assets/images/imagesresponsive.JPG">

# User Experience

### Project Goals:
<p> The goal of this project is to offer a range of stand out dresses that can be worn on any occasion. The user will be thr ability to create an account, add items to their basket, make payments and have a profile to view the previous orders. The target audience are people who enjoy feminine and unique dresses. People who seek limited edition and artistic dresses.
</p>

### Target Audience Goals:
* A site that is easy to navigate on mobile, tablet and desktop.
* A site that is appealing, intriguing and unique.
* A site that clearly displays it's purpose and objective.
* A site that allows you to browse through the items we sell.
* A site that allows you to add items to your basket and purchase items.
* A site that allows you to sign up or login. 
* A site that allows you to leave a review on a item you purchased.
* A site that allows you to see your previous orders.

### Site Owner Goals:
* A site that is user friendly and easy to navigate.
* A site that easily provides a user with our purpose and objective.
* A site that encourages users to sign up and create an account.
* A site that provides users with a safe and secure e-commerce platform in order to generate revenue from sales.
* A site that creates frequent and loyal users.
* A site that allows users to leave reviews on a item they ourchased which other sers can read.
* A site that encourages user sales with high standard of quality dresses and reasonable prices.

## User Stories

### EPIC|Viewing and Navigation

* As a Site User:
    * I can view the homepage so that I can understand the sites purpose to determine if it suits my needs.
    * I can use the nav and footer elements so that I can navigate to different areas of the website and external links.
    * I can view the products page so that I can decide what I would like to purchase.
    * I can click into each individual product so that I can get more information on the product.
    * I can view the different collections so that I can view the products I am interested in buying without searching through all the products.
    * I can view the item that is on sale so that I can purchase an item at a reduced rate.
    

* As a Site Owner:
    * I want the user to view the landing page so they can immediately understand the sites use and purpose.
    * I want to provide easy navigation to different areas of the site to enhance the user experience.
    * I want to provide the user with a products page so the user can view all the items they can puchase.
    * I want to offer users the option to click into each individual product so they have more information on the product.
    * I want to provide the user with the different individual collections so the use can find the products they like with ease.
    * I want to display the sale so the user can purchase an item at a reduces rate and save money.

## EPIC|Registration and User Accounts

* As a Site User:
    * I can register for an account so that I can add my personal information and view my order history.
    * I can login and logout of my account so that I can access my personal information.
    * I can receive an email registration confirmation email so that I can verify my account registration was successful.
    * I can have a personal profile so that I can view my order history, order confirmation and save my preferred address.
    * I can recover my password if I forget it so that I can recover access to my account.
    * I can get in contact with the site owner via the contact form to ask any question I have.

* As a Site Owner:
    * I want the user to have an option to create an account so they can add their personal information and view their order history.
    * I want the user to be able to login and logout, to give them access to their personal information.
    * I want the user to receive an email registration confirmation email so that they can verify their account registration was successful.
    * I want the user to have a personal profile so that they can view their order history, order confirmation and save their preferred address.
    * I want the user to be able to recover their password if they forget it so that they can recover access to their account.
    * I want the user to be able to contact me via the contact form to ask any question they have.

### EPIC|Purchase and Checkout

* As a Shopper:
    * I can select the size and quantity of a product so that I can select the desired item.
    * I can view the current items in my bag so that I can see what I am about to purchase and the total cost.
    * I can adjust the quantity of the items in my bag so that I can make changes to my purchase before checkout.
    * I can enter my payment information so that I can checkout and purchase the items in my bag.
    * I can view my order confirmation so that I can review my purchase.
    * I can receive an email confirming my purchase so that I have a record of my purchase.
    * I can add, edit and delte a review on an item I have recently purchased so that I can share my thoughts and feedback on my purchase.

* As a Site Owner:
    * I want the user to be able to select the size and quantity of a product so that I can select the desired item.
    * I want the user to be able to view the current items in their bag so that they can see what they are about to purchase and the total cost.
    * I want the user to be able to adjust the quantity of the items in their bag so that they can make changes to their purchase before checkout.
    * I want the user to be able to enter their payment information so that they can checkout securly and purchase the items in their bag.
    * I want the user to be able to view their order confirmation so that they can review their purchase.
    * I want the user to receive an email confirming their purchase so that they have a record of their purchase.
    * I want the user to be able to add, edit and delete a review on an item they have recently purchased so that they can share their thoughts and feedback on the purchase.

### EPIC|Sorting and Searching

* As a Shopper:
    * I can sort the list of available products so that the items match my preference.
    * I can sort a specific collection of products so that the items match my preference.
    * I can search for a product by name or description so that I can refine my search.
    * I can view my search results and the number of results so that I can view the refined products.

* As a Site Owner:
    * I want the user to be able to sort the list of available products so that the items match their preference.
    * I want the user to be able to sort a specific collection of products so that the items match their preference
    * I want the user to be able to search for a product by name or description so that they can refine their search.
    * I want the user to view their searched results and the number of results so that they can view the refined products.

### EPIC|Admin and Store Management

* As an Admin:
    * I can add a product so that I can add new items to my store.
    * I can update a product so that I can edit the product details.
    * I can delete a product so that I can remove any items that are no longer required.


## Design Choices:
<p> The design of the site needs to draw the user in with hopes they stay and purchase the items we sell. The colours need to be appealing and compliment the the content and the product images. The site will have a feminine and elegant theme to help portray the produts we sell. The design will ensure the site is easily navigated which will result in users returning and signing up. 
</p>

### Fonts:
* [Caveat](https://fonts.google.com/specimen/Caveat?category=Display,Handwriting&preview.text=Hellop&preview.text_type=custom)
* [Comfortaa](https://fonts.google.com/specimen/Comfortaa?subset=chinese-traditional)
<p>I chose these font families for the website as they compliment the colour scheme, theme and the content well. They are easily readable and add to the clean and elegant style.
</p>

### Icons:
<p>I have used multiple icons from font-awsome. They offer a wide range of icons and will help the user to identify the buttons use. For example, icons were used for edit and deleting comments.
</p>

### Colours:
<p> I chose the colours below because they portray a feminine and elegant feel. They compliment themselves, the content and the product images well. The content is clearly readable and the site navigates well due to the colours. It increases the appeal of the website and UX. The colours used across the site are listed below.
</p>

* Primary Colour - White, #FFF.
* Secondary Colour - Black, #000.
* Tertiary Colour - Pink, #CB807D

![Colors](https://github.com/AshFitz/nothing_on_earth/blob/main/assets/images/colors.png)

### Images
<p> I selected images and a video that is in contrast with the theme of femininity and elegance. They help the user undersand the sites purpose and the we have to sell, they also help the user determine if this type of site and products will suit their needs. These images and videos were used throughout the site, the homepage, the product page, the product details page and the bag etc. The images were sourced from  <a href="https://sisterjane.com/">Sister Jane.
</p>

## Wireframes:
<p> The wireframes were created in <a href="https://balsamiq.com/" target="_blank">balsamiq</a>. This helped me to plan the visual look of the website. I created wireframes for mobile, tablet and desktop.
</p>

<p> The wireframes for the project can be found <a href="https://github.com/AshFitz/nothing_on_earth/tree/main/wireframes" target="_blank">here.</a></p>

### Business Model

The business model for this store would be B2C, business to customer. This is because the business is selling the products directly to the customer.

### Marketing 

The site uses 2 different marketing strategies, social media and a newsletter that users can subscribe to.

- Links to the social media page can be found in the footer. The Facebook link takes the user directly to the Noting On Earth business page. Find the page  [here](https://www.facebook.com/Nothing-On-Earth-110107378460514). Facebook deletes inactive business pages, if the page has been deleted, find the images here . ![Facebook](https://github.com/AshFitz/nothing_on_earth/tree/main/assets/images)

- The newsletter sign up form can also be found in the footer. This service is powered by [Mailchimp](https://mailchimp.com/en-gb/). ![Newsletter](https://github.com/AshFitz/nothing_on_earth/blob/main/assets/images/mailchimp.JPG)

### Search Engine Optimisation

I created a sitemap.xml and robots.txt file to help aid search engines locate the site. To keep user's information safe and  pages that may contain sensitive information has been included in the robots.txt.

The keywords and phrases are below:

#### Short Tail Keywords
- Dress
- Pretty dress
- Womens dresses
- Wedding dress
- Midi dress
- Mini dress
- Long dress
- Black dress
- Pink dress
- White dress
- Frock
- Gown

#### Long Tail Keywords
- Dresses for evening times
- Dress for summer time
- Dresses for parties
- Feminine and elegant dresses
- Dresses for all occasions
- Dresses as a wedding guest

These phrases can also be used in the metadata at the head of the page.

### Database Design:
* In the production version of we went the database is utilizing PostgreSQL and is hosted and provided by Heroku.

#### The Checkout App:
##### Order Model
      Name     |    Key in db   |   Field Type    |   Arguments
     :-----:   |     :-----:    |     :-----:     |    :-----:
Order Number   | order_number   | CharField       | max_length=32, null=False, editable=False
User Profile   | user_profile   | ForeignKey      | UserProfile, on_delete=models.SET_NULL, null=True, blank=True, related_name='orders'
Full Name      | full_name      | CharField       | max_length=50, null=False, blank=False
Email          | email          | EmailField      | max_length=254, null=False, blank=False
Phone Number   | phone_number   | CharField       | max_length=20, null=False, blank=False
Country        | country        | CountryField    | blank_label='Country *', null=False, blank=False
Postcode       | postcode       | CharField       | max_length=20, null=True, blank=True
Town or City   | town_or_city   | CharField       | max_length=40, null=False, blank=False
Street Address1| street_address1| CharField       | max_length=80, null=False, blank=False
Street Address2| street_address2| CharField       | max_length=80, null=True, blank=True
County         | county         | CharField       | max_length=80, null=True, blank=True
Date           | date           | DateTimeField   | max_length=80, null=True, blank=True
Delivery Cost  | delivery_cost  | DecimalField    | max_digits=6, decimal_places=2, null=False, default=0
Order Total    | order_total    | DecimalField    | max_digits=10, decimal_places=2, null=False, default=0
Grand Total    | grand_total    | DecimalField    | max_digits=10, decimal_places=2, null=False, default=0
Original Bag   | original_bag   | TextField       | null=False, blank=False, default=''
Stripe PID     | stripe_pid     | CharField       | max_length=254, null=False, blank=False, default=''

##### Order Line Item Model
      Name     |    Key in db   |   Field Type    |   Arguments
     :-----:   |     :-----:    |     :-----:     |    :-----:
Order          | order          | ForeignKey      | Order, null=False, blank=False, on_delete=models.CASCADE, related_name='lineitems'
Product        | product        | ForeignKey      | Product, null=False, blank=False, on_delete=models.CASCADE
Product Size   | product_size   | CharField       | max_length=2, null=True, blank=True
Quantity       | quantity       | IntegerField    | null=False, blank=False, default=0
Line Item Total| lineitem_total | DecimalField    | max_digits=6, decimal_places=2, null=False, blank=False, editable=False

#### The Contact App:
##### Contact Form Model
      Name     |    Key in db   |   Field Type    |   Arguments
     :-----:   |     :-----:    |     :-----:     |    :-----:
First Name     | first_name     | CharField       | max_length=80, blank=False, null=False
Last Name      | last_name      | CharField       | max_length=80, blank=False, null=False
Email          | email          | EmailField      | max_length=254, null=False, blank=False
Phone          | phone          | CharField       | max_length=20, null=False, blank=False, default=''
Message        | message        | TextField       | null=False, blank=False

#### The Products App:
##### Collection Model
      Name     |    Key in db   |   Field Type    |   Arguments
     :-----:   |     :-----:    |     :-----:     |    :-----:
Name           | name           | CharField       | max_length=254,null=True, blank=True
Friendly Name  | friendly_name  | CharField       | max_length=254, null=True, blank=True

##### Product Model
      Name     |    Key in db   |   Field Type    |   Arguments
     :-----:   |     :-----:    |     :-----:     |    :-----:
Collection     | collection     | ForeignKey      | 'Collection', null=True, blank=True, on_delete=models.SET_NULL
SKU            | sku            | CharField       | max_length=254, null=True, blank=True
Name           | name           | CharField       | max_length=254
Description    | description    | TextField       |
Details        | details        | TextField       | max_length=254, null=True, blank=True
Has Sizes      | has_sizes      | BooleanField    | default=True, null=True, blank=True
Sale           | sale           | BooleanField    | default=False, null=True, blank=True
Price          | price          | DecimalField    | max_digits=6, decimal_places=2
Image URL      | image_url      | URLField        | max_length=1024, null=True, blank=True
Image 2 URL    | image2_url     | URLField        | max_length=1024, null=True, blank=True
Image          | image          | ImageField      | null=True, blank=True
Image2         | image2         | ImageField      | null=True, blank=True

##### Review Model
      Name     |    Key in db   |   Field Type    |   Arguments
     :-----:   |     :-----:    |     :-----:     |    :-----:
Product        | product        | ForeignKey      | Product, on_delete=models.CASCADE, null=True, blank=True,related_name='reviews'
User           | user           | ForeignKey      | User, on_delete=models.CASCADE, null=True, blank=True, related_name='user_review'
Comment        | comment        | TextField       | max_length=1000, blank=True, null=True
Timestamp      | timestamp      | DateTimeField   | auto_now_add=True

#### The Profiles App:
##### User Profile Model
           Name        |        Key in db       |   Field Type    |   Arguments
          :-----:      |         :-----:        |     :-----:     |    :-----:
User                   | user                   | OneToOneField   | User, on_delete=models.CASCADE
Default Phone Number   | default_phone_number   | CharField       | max_length=20, null=True, blank=True
Default Street Address1| default_street_address1| CharField       | max_length=80, null=True, blank=True
Default Street Address2| default_street_address2| CharField       | max_length=80, null=True, blank=True
Default Town Or City   | default_town_or_city   | CharField       | max_length=40, null=True, blank=True
Default County         | default_county         | CharField       | max_length=80, null=True, blank=True
Default Postcode       | default_postcode       | CharField       | max_length=20, null=True, blank=True
Default Country        | default_country        | CountryField    | blank_label='Country', null=True, blank=True

## Features:

### Featured that have been developed:

* <p>Account registration, a user can login and access their profile and previous orders.</p>
* <p>A user can update their saved information through their profile.</p>
* <p>A list of products a user can view. They can also select each product to find out more information on the product.</p>
* <p>A shopping bag that users can add items to. They also have the ability to edit and remove items.</p>
* <p>A user can complete a purchase and checkout with the items in their bag using the Stripe API which processes the payment securley. The user will also be able to view their order confirmation.</p>
* <p>A user can get in contact with us via email by filling out the contact form.</p>
* <p>A user who has purchased an item will have the ability to leave a review on the item.</p>

### Featured that have been developed:
* <p> A user will have he ability to sign up to a newsletter subscription. </p>
* <p> A star rating within the review functionality.</p>
* <p> A user will have the ability to save items that they like, to come back to them at a later stage without having to look through all the products agian.</p> 

## Technologies Used:
#### Languages:
* <a href="https://developer.mozilla.org/en-US/docs/Web/HTML" target="_blank">HTML</a>
* <a href="https://developer.mozilla.org/en-US/docs/Web/CSS" target="_blank">CSS</a>
* <a href="https://www.w3schools.com/js/" target="_blank">JavaScript</a>
* <a href="https://www.json.org/json-en.html" target="_blank">JSON</a>
* <a href="https://www.python.org/" target="_blank">Python</a>

#### Tools & Libraries:
* <a href="https://www.djangoproject.com/" target="_blank">Django</a>
* <a href="https://pip.pypa.io/en/stable/installation/" target="_blank">PIP</a>
* <a href="https://jquery.com/" target="_blank">jQuery</a>
* <a href="https://git-scm.com/" target="_blank">Git</a>
* <a href="https://getbootstrap.com/" target="_blank">Bootstrap</a>
* <a href="https://fontawesome.com/icons?d=gallery" target="_blank">Font-Awesome</a>
* <a href="https://stripe.com/" target="_blank">Stripe</a>

#### Databases:
* <a href="https://www.postgresql.org/" target="_blank">PostgreSQL - Production</a>
* <a href="https://www.sqlite.org/index.html" target="_blank">SQlite3 - Development</a>

## Planning and Testing:

#### Planning:

<p> Creating the wireframes really helped the planning of this project. It layed out what I wanted to achieve and you could visually see what was possible and what was not.</p>

<p> I took an aglie styled approach. I took time creating my user stories to keep within my time-frame and focus on the most important features and functionalities. I also included the acceptance criteria for each user story and tagged them based on their importance. If a user story began it was taken from the to do column and moved to in progress. Once each user story was completed it was then moved to the done box. I focused on not spending too much time on a particular ticket I was having issues with. I would move this back to to-do and try to complete the other tickets within the in progrss column. Using this method was brilliant for time-management. I was using my time well and at each point in the progress I had a clear understanding of the next steps and the overall goal.</p>

<p> A part of my planning was using <a href="https://coolors.co/" target="_blank">coolors</a> to chose the correct colour palette.</p>

#### Feature Testing:

#### User Testing
<p> Testing was completed throughout the development process using chrom dev toos and user testing myself.</p>

### User Profile

#### Expectation

Users can register, login and have a personal profile that contains their saved information and previous orders.

#### Implementation

Django-Allauth was used to handle the registration of users. User profile model has custom fields when registering. Profile that includes the features, my saved information and previous orders. 

#### Test 

  * When not logged in: Navigate to the sign up page via the nav
	* When not logged in: Create an account and fill out all the required fields
	* When not logged in: Navigate to login page via the nav and fill out all the required field
  * When logged in: Navigate to profile page and view my saved information and previous orders.

#### Result

Users can signup and a profile can be created using signals. The user profile is interactive and the correct information is displayed.

#### Verdict

This test has passed.

### Products 

#### Expectation

View a list of products, see information related to that product, sort products by price.

#### Implementation

A products page was created displaying a list of cards that provide a brief description of each product, the name and the collection.
Within the nav there is also a nav item to select each individual collection to help improve the user experience.

#### Test

* Navigate to the products page via the nav and check products are displayed
* Sort the product by price via the select option box
* Click on the collection nav item to see that all links work
* Navigate to the individual products to confirm it displays all the product information 

#### Result

All products have displayed as expected, sorting of the products by price displays the products in the correct order. Each individual product has a product detail page with all the relevant information.

#### Verdict

This test has passed.

-----

### Reviews

#### Expectation

A user will only have the ability to review an item they have already purchased. They will only have access to review the product once. They also have the ability to edit and delete the review they have submitted.

#### Implementation

A review section is displayed on the product details page under the product image and product information. This displays reviews that the user and other users have submitted. This also includes a link for the user to edit and delete their own review. A review app is built inside the products app and if the user has purchased this item they have the ability to submit a review. This is handled by template variables and if statements to confirm the user has met all of the conditions, only then will a review form display for the user.

#### Test

* When not logged in, I navigate to a product detail page, the product detail page displays a message stating that I can only leave a review when I purchase the item.
* Register for an account or login, I navigate to a product detail page and a message is displayed stating that I can only leave a review when I purchase the item.
* Purchase a product and then navigate back to that product detail page, review form is diplayd and a review can be submitted.
* Reload the product detail page and my review is displayed. I can also edit and delete my review. When I delete my review it is no longer displayed. When I edit my review I am navigated to the edit review url and the edit form is displayed.
* Toast messages are displayed when a review is updated or deleted. 

#### Result

Only users who have purchased the item have the ability to review that item.

#### Verdict

This test has passed.

-----

### Bag & Checkout

#### Expectation

Select products and add them to the bag. Remove products from bag, edit product quantities, select product size, purchase the bag using secure checkout and recieve confirmation email.

#### Implementation

Create a cart using session storage, user is notified of bag products,quantities and sizes via toast messages. The bag page confirms the products and product details. A form is created from the order model and this validates the information before processing the payment, this also informsthe user of any errors. After successful payment. A success page is displayed with the users order confirmation. A user can make a purchase with or without having an account registered.

#### Test

Testing for both a user logged in and a user not logged in.
* Navigate to products page, select an item, selecting the relevant size and add it to the bag. A product can not be added to the bag without a size being selected
* Upate thhe quantity of this product to 2
* Navigate to another product and add it to the bag, repeat this step 3 times
* The bag willbe located within the nav and will display the number of products within the bag. Select the bag
* Review the products within the bag, edit the bag by updating a products size and quantity and also remove an item
* Click to go to the payment page
* Fill out the required information and use the stripe card details, ```4242 4242 4242 4242```
* Payment sucess/fail will be displayed

#### Result

Products can be added to the bag easily. The user must select a size before adding it to the bag. A user is displayed with their bag quantity within the nav at all times. The user has the ability to edit their bag by updating the product size and quantity and the user can also delete a product from the bag. When checking out the user is displayed with crispy form fields and the grand total is clearly displayed including the price breakdown, delivery charge and/or sale discount. When the payment is processing a loading spinner is displayed to notify the user of the payment being processed. The user is notified with a payment confirmation and an email is also sent to the user with the confirmation of purchase.

#### Verdict

This test has passed.

-----

### Toast Messages

#### Expectation

Users are notified of certain interactions via pop-up messages, info, success or error.

#### Implementation

Bootstrap toast system is linked to django messages module. The user is notified of specific interactions throughout the site. The messages display different information to the user and they are styled to suit theme of the site.

#### Test

* Add a product to the bag
* Edit a product in the bag
* Delete a product in the bag
* Login
* Logout 
* Register for an account
* Submit the contact form


#### Result

Toast messages are displayed when the user carries out the above interactions. The user is either shown a success, info or error message to inform them of their interactions and make the user aware.

#### Verdict

This test has passed.

-----

### Contact Form

#### Expectation

Users have the ability to get in contact with the site owner by submitting a contact form. A user should have this ability regardless of if they have logged in or not.

#### Implementation

A contact page was created to display the contact form. This form has all nessecary fields for the user to submit their question.

#### Test

* Aa a user that has logged in and not logged in, navigate to the contact form and fill out the nessecary fields.
* Submit the form and confirm it has been processed and delivered.
* Check  the email was sent in the django console email backend.
* Check the email was been sent in the django smtp email backend.
* Toast message will be displayed to the user confirming the contact form was submitted.

#### Result

Users have the ability to enter their email and type in their query within the required filed. It has been processed and the contact form was submitted to the db incase it fails to send.

#### Verdict

This test has passed.

-----

### Stripe Payments

#### Expectation

Payments are handled securely to protect sensitive user information

#### Implementation

Using the stripe package and creating webhooks to verify with stripe. Follow the Boutique Ado project and the stripe documentation.

#### Test

Users have the ability to checkout and submit their order. Check the stipe dashboard for webhooks ensure payment intent and payment success was displayed on each order. 


#### Result

The payments are handled securely using the systems provided by stripe. No duplicate orders are created due to the webhook finding the order and submitting correctly.


#### Verdict

This test has passed

-----

### Browser Compatibility

#### Expectation

The application displays and functions on different browsers.

#### Implementation

Use of code that is widley supported.

#### Test

This application was developed using the brave and chrome dev tools. Testing of IE, Firefox and safari has not been completed.


#### Result

The application functions as expected on browsers.


#### Verdict

This test has passed.

-----

## Bugs

### Known Bugs
* For mobile, the bag page could be more user friendly. The user has to slighly scroll across the screen to view all the content. Given more time I would have fixed this issue, to prevent any scrolls, keeping things as easy as possible for the user and creating a better user experinece.
* The search drop down bar is not exact and doesn't cover the full with of the page. With more time this would be refined to ensure the search bar is consistent and extends fully across each screen size.
* Contact form With more time I would implement it to actually send a direct email with the body and subject, for now it just sends the admin a notification that they have a request waiting in the admin panel.

### Create a New Repository
1. Log into Github.
2. Open the "Repositories" tab and click "New".
3. Name the repository and click "Create Repository".
4. You are set up and ready to get started.

### Forking the Repository
By forking the GitHub Repository we make a copy of the original repository on our GitHub account to view and/or make changes without affecting the original repository by using the following steps

1. Log into [GitHub](https://github.com/login "Link to GitHub login page") or [create an account](https://github.com/join "Link to GitHub create account page").
2. Locate the [GitHub Repository](https://github.com/Kat632/PP4-LettuceEat "Link to GitHub Repo").
3. At the top of the repository, on the right side of the page, select "Fork"
4. You should now have a copy of the original repository in your GitHub account.

### Creating a Clone
How to run this project locally:
1. Install the [GitPod Browser](https://www.gitpod.io/docs/browser-extension/ "Link to Gitpod Browser extension download") Extension for Chrome.
2. After installation, restart the browser.
3. Log into [GitHub](https://github.com/login "Link to GitHub login page") or [create an account](https://github.com/join "Link to GitHub create account page").
4. Locate the [GitHub Repository](https://github.com/Kat632/PP4-LettuceEat "Link to GitHub Repo").
5. Click the green "GitPod" button in the top right corner of the repository. This will trigger a new gitPod workspace to be created from the code in github where you can work locally.
6. After cloning the repository, begin by typing python3 manage.py makemigrations --dry -run 
7. Then enter, python3 manage.py makemigrations
8. Ather that enter, python3 manage.py migrate
9. Lastly enter, python3 manage.py createsuperuser

How to run this project within a local IDE, such as VSCode:

1. Log into [GitHub](https://github.com/login "Link to GitHub login page") or [create an account](https://github.com/join "Link to GitHub create account page").
2. Locate the [GitHub Repository](https://github.com/Kat632/PP4-LettuceEat "Link to GitHub Repo").
3. Under the repository name, click "Clone or download".
4. In the Clone with HTTPs section, copy the clone URL for the repository.
5. In your local IDE open the terminal.
6. Change the current working directory to the location where you want the cloned directory to be made.
7. Type 'git clone', and then paste the URL you copied in Step 3.
```
git clone https://github.com/USERNAME/REPOSITORY
```
8. Press Enter. Your local clone will be created.

Further reading and troubleshooting on cloning a repository from GitHub [here](https://docs.github.com/en/free-pro-team@latest/github/creating-cloning-and-archiving-repositories/cloning-a-repository "Link to GitHub troubleshooting")

### Django
The Django framework was used in this project. Follow the below steps to install django.

1. In the terminal enter: "pip3 install django"
2. You then name your project by entering: "django-admin startapp projectname"
3. You then add a gitignore file by entering: "touch .gitignore"
4. Inside this file you must include: 
   ``` 
    *.sqlite3
    *.pyc
    __pycache__
    ```
5. In the termail again, run the command: "python3 manage.py runserver"
6. You then need to perform the initial migrations. You do this in the termial by entering: "python3 manage.py runserver"
7. You need to create a superuser to access the admin panel. Again, you do this in the termail, by entering "python3 manage.py createsuperuser". You will then be prompted to create a username and a password, the email address prompt is optional.
8. Lastly, you can push your changes to github by entering the following commands:
    ```
    git add .
    git commit -m "initial commit"
    git push
    ```

### Allauth
Allauth is a package inside the django framework. This handles account registraion, login/logout, email confiration and password recovery. Allauth can be installed byu following the steps [here](https://django-allauth.readthedocs.io/en/latest/installation.html).

### Heroku Deployment

I deployed the project using Heroku.

1. Go to the [Heroku](https://id.heroku.com/login) site
2. Log in.
3. Click the "New" button and click "Creat new app"
4. Provide a name for the app in the "App name" field
5. Select your region from the dropdown menu
6. Click "Create App"
7. Add Database to App Resources, located in the Resources Tab, Add-ons, search and add e.g. ‘Heroku Postgres’
8. Click "Plan Name" and select "Hobby Dev - Free", then select "Submit Order Form".

To use Postgres follow the steps below:

1. In your terminal enter: "pip3 install dj_database_url"
2. Then enter: "pip3 install psycopg2-binary"
3. To install all your required apps enter: "pip3 freeze > requirements.txt"
4. Then go to your main settings.py file and at the top of the file enter: "import dj_database_url"
5. Under the databse settings section, comment out the default configuration. Under this enter: 
    ```
    DATABASES = {
        'default': dj_database_url.parse(*Enter Database URL here*)
    }
    ```
    You can find the database url in the settings tab of Heroku, in the config vars section.
6. You now need to run migrations, you do this by entering: "python3 manage.py migrate"
7. You then need to create a superuser by entering: "python3 manage.py createsuperuser"
8. Then login to the admin panel, got to the users tab and select the user. Verify the email address to ensure you can login to the site.
9. Uncomment the default configuration that was commented out in step 5.
10. Still in the database section, we must create an if statement to use sqlite if not running the postgres database when using the app on heroku. Confirm your code looks like the below to do this:
    ```
    if 'DATABASE_URL' in os.environ:
        DATABASES = {
            'default': dj_database_url.parse(os.environ.get('DATABASE_URL'))
        }
    else:
        DATABASES = {
            'default': {
                'ENGINE': 'django.db.backends.sqlite3',
                'NAME': BASE_DIR / 'db.sqlite3',
            }
    }
    ```
11. Next we must install gunicorn. Enter this in the termail: "pip3 install gunicorn". 
12. After this we again need to freeze the requirements entering: "pip3 freeze > requirements.txt"
13. Then we need to create a Procfile. In the root directory create a file called "Procfile". Within the file enter "web: gunicorn projectname.wsgi:application"
14. Next go to Heroku, in the settings tab. Witin the config vars input Key: "DISABLE_COLLECTSTATIC" and Value: "1", then select the add button.
15. Next go to your project, in the main settings file under Allowed Hosts. Confirm your code looks like this: "ALLOWED_HOSTS = ['projectname.herokuapp.com', 'localhost']"
16. Then commit these changes and push them. Then push the changes to Heroku by entering: "git push heroku main". Your app is now deployed, there is no static files but this is covered in AWS.
17. You can also select for your project to automatically delploy to Heroku each time you push your changes through github. You can do this by going to the deploy tab and connect to github under the deployment method. You the search for your repo and select connect. There is an option to "Enable automatic deploys". Select this option for this to work. 

### AWS
To store all the static and media files, I used Amazon Web Services. Follow the steps below to do this.

#### S3

1. You must signup to AWS and create an account [here](https://aws.amazon.com/).
2. Under All Services, Storage Menu, select S3.
3. On this page you will need to create a new bucket by selecting "Create Bucket".
4. Name the bucket and chose your region.
5. Under "Object Ownership" select "ACLs enabled". 
6. Uncheck "Block all public access", check the box to acknowledge the buket will be public and create the bucket.
7. Click on the bucket and go to the properties tab. At the end of the page you will see "Static website hosting", select edit and change the option to "Enabled". Copy the values for both the index and error documents and then save the changes.
8. In the permissions tab, find the CORS section, select edit and paste in the below: 
    ```
    [
        {
            "AllowedHeaders": [
            "Authorization"
            ],
            "AllowedMethods": [
            "GET"
            ],
            "AllowedOrigins": [
            "*"
            ],
            "ExposeHeaders": []
        }
    ]
    ```
9. Now got to the "Bucket Policy" and click edit, then policy generator. The select "select a type of policy" and select "S3 Bucket Policy". Allow all principle by typing *.
10. Select "Actions dropdown", choose "Get object". Next go back to the previous tab to locate the Bucket ARN number. Copy this in the policy generator under the filed ARN.
11. Add the statment and then generate the policy. Copy the policy thats generated and past it into the bucket policy editor.
12. Add /* to the end of your resource key and the select save.
13. Go to the ACL section and click edit. Next to "everyone(public access)", check "list". You will be prompted with a warning but select the and the save.

#### IAM

1. We must creat a user to access the bucket. Search IAM and select it.
2. Select "User Groups" an then "Create Group". Name the group, manage-projectname and select "Create Group".
3. Select "Policies" and then "Create Policy".
4. Navigate to the JSON tab and click "Import managed policy". Search S3 and select "AmazonS3FullAccess" and import.
5. Go back to your bucket and copy the ARN number. Go back to the policy and change the resource key to your ARN number. Your code should match the below:
    ```
    {
        "Version": "2012-10-17",
        "Statement": [
            {
                "Effect": "Allow",
                "Action": [
                    "s3:*",
                    "s3-object-lambda:*"
                ],
                "Resource": [
                    "ARN-NUMBER",
                    "ARN-NUMBER/*"
                ]
            }
        ]
    }
    ```
6. Select "Next: Tags" and "Next: Review", then name the policy, followed by the workd policy. Give a short description and then creatw the policy.
7. Back on the policy page, you must attach it to the group you created. Click "User Groups" and select your created group. Go the the permissions tab and "Add permission. Select "Attach policies".
8. Select the polciy you created and "Add permissions".
9. You must create a useer to put in the group. Select users and click "Add user".
10. Name the user and click "Programmatic Acces", then "Next: Permissions".
11. Select the group with the attached policy and click "Next: Tags", "Next: Review" and "Create User".
12. Download the CSV file. This has the user access key and secret key.

#### Connect AWS to Django
We now must connect the S3 bucker and the user group attached to django.

1. We must install 2 packages, in the termail enter: "pip3 install boto3" and "pip3 install django-storages". We then must freeze the requirements again by entering: "pip3 freeze > requirements.txt".
2. Then add "storages", to the installed apps within the main settings.py.
3. Create an if statement to check if there is an environment variable call USE_AWS. Your code should look like the below:
    ```
    if 'USE_AWS' in os.environ:
        AWS_STORAGE_BUCKET_NAME = 'your-bucket-name'
        AWS_S3_REGION_NAME = 'your-region'
        AWS_ACCESS_KEY_ID = os.environ.get('AWS_ACCESS_KEY_ID')
        AWS_SECRET_ACCESS_KEY = os.environ.get('AWS_SECRET_ACCESS_KEY')
    ```
4. Go back to the settings tab in Heroku, under config vars, you must ass the keys with the values that you previously downloaded. Add the Key: AWS_ACCESS_KEY_ID and the value in the downloaded CSV file. Then add Key: AWS_SECRET_ACCESS_KEY and again the value from the file. Next, add Key: USE_AWS, Value: True.
5. Remove the DISABLE_STATIC variable.
6. In the main settings.py file, add the below to the if statement we created in step 3:
    ```
    AWS_S3_CUSTOM_DOMAIN = f'{AWS_STORAGE_BUCKET_NAME}.s3.amazonaws.com'
    ```
7. In the root directory create a file called "custom_storages.py". Inside this file we must import:
    ```
    from django.conf import settings
    from storages.backends.s3boto3 import S3Boto3Storage
    ```
8. Under the import enter the classes:
    ```
    class StaticStorage(S3Boto3Storage):
        location = settings.STATICFILES_LOCATION


    class MediaStorage(S3Boto3Storage):
        location = settings.MEDIAFILES_LOCATION
    ```
    The STATICFILES_LOCATION and MEDIAFILES_LOCATION will be defined next.
9. In the sttings.py file, under the bucket config settings, inside the if statement add:
    ```
    STATICFILES_STORAGE = 'custom_storages.StaticStorage'
    STATICFILES_LOCATION = 'static'
    DEFAULT_FILE_STORAGE = 'custom_storages.MediaStorage'
    MEDIAFILES_LOCATION = 'media'
    STATIC_URL = f'https://{AWS_S3_CUSTOM_DOMAIN}/{STATICFILES_LOCATION}/'
    MEDIA_URL = f'https://{AWS_S3_CUSTOM_DOMAIN}/{MEDIAFILES_LOCATION}/'
    ```
10. Commit and push these changes to see your S3 bucket now has a static folder with all your static files.
11. Add the code below inside the if statement to cache the static files:
    ```
    AWS_S3_OBJECT_PARAMETERS = {
        'Expires': 'Thu, 31 Dec 2099 20:00:00 GMT',
        'CacheControl': 'max-age=94608000',
    }
    ```
12. In S3 navigate to your bucket and click "Create Folder". Name this folder "Media" and save it.
13. Inside this folder, click "Upload" and "Add Files", you then select the images you are using on your site.
14. In "Permissions" select the option to "Grant public-read-access" and select upload.
15. All the static and media filed are now automatically linked and you are ready to go.

### Stripe

Stripe is used handle the checkout process when a payment is made. You must signup for a stripe account [here](https://stripe.com/en-gb).

#### Payments

1. Follow their guide to set up stripe payments [here](https://stripe.com/docs/payments/accept-a-payment#web-collect-card-details)

#### Webhooks

1. Sign into your stripe account and click 'Developers' in the navbar.
2. Under the Developers title, select 'Webhooks' and 'Add endpoint'.
3. You must input this link to your heroku app followed by /checkout/wh/. Your code should look like the below:  
    ```
    https://app-name.herokuapp.com/checkout/wh/
    ```
4. Next, click '+ Select events' and then 'Select all events'. Now select 'Add events' and 'Add endpoint'.
5. Your webhook is now created and a secret key has been generated. You must add this to your Heroku config vars.
6. In Keroku and navigate to the config vars section in settings. You will need the secret key generated for your webhook. You also need the Publishable key and secret key. This can be found in the API keys section in stripe.
7. Add these values under the keys:  
    ```
    STRIPE_PUBLIC_KEY = 'insert your stripe publishable key'
    STRIPE_SECRET_KEY = 'insert your secret key'
    STRIPE_WH_SECRET = 'insert your webhooks secret key'
    ```
8. In your main setting.py file in django, insert the below at the bottom of the file:  
    ```
    STRIPE_PUBLIC_KEY = os.getenv('STRIPE_PUBLIC_KEY', '')
    STRIPE_SECRET_KEY = os.getenv('STRIPE_SECRET_KEY', '')
    STRIPE_WH_SECRET = os.getenv('STRIPE_WH_SECRET', '')
    ```


### References
<p>
This project was created by following the Boutique Ado project provided by [Code Institute](https://codeinstitute.net/). This project was customised and modified to meet my needs.<br>
[Multiple questions answered with the help of](https://stackoverflow.com/)<br>
</P>

## Images
* Images and videos for the website came from [Pexels](https://pexels.com/) and [Sister Jane](https://eu.sisterjane.com/)

### Acknowledgements

<p> I would to say a big thank to the [Code Institute](https://codeinstitute.net/) and tutor support for all their help and support throughout the project. </p>

<p><strong>This project is for educational purposes only. It was created as a milestone project for Code Institutes full stack web development course.</strong></p>


